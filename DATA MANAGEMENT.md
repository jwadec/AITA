# AI Teaching Assistant (AITA) SharePoint Lists Setup

The AI Teaching Assistant (AITA) utilizes Microsoft SharePoint lists to store and manage data throughout its workflow. Below is a breakdown of the SharePoint lists, the fields within each list, and how they are set up.

## SharePoint Lists Overview

Two main SharePoint lists are used in this setup:

1. **Announcement List**: Stores the generated announcements for each course and week, including relevant metadata.
2. **Approval Log List**: Tracks faculty responses to announcements, including whether the announcements were accepted or rejected and any feedback provided.

### 1. Announcement List

This list contains the announcements generated by the AI Teaching Assistant. Each entry in this list represents an announcement for a specific course and week.

- **Fields**:
  - **AnnouncementID**: *(Number)* A unique identifier for each announcement entry. This is auto-generated and serves as the primary key for each record.
  - **CourseName**: *(Single line of text)* The name of the course for which the announcement is generated.
  - **CourseCode**: *(Single line of text)* The code of the course (e.g., "ACCT 2301").
  - **WeekNumber**: *(Number)* The week of the course for which the announcement is generated (e.g., Week 1, Week 2, etc.).
  - **AnnouncementHTML**: *(Multiple lines of text)* The HTML content of the announcement generated by GPT-4.
  - **GeneratedDate**: *(Date and Time)* The date and time when the announcement was generated.
  - **Status**: *(Choice)* Indicates the current status of the announcement, such as "Pending Approval," "Approved," or "Rejected."
  - **FacultyApprovalURL**: *(Hyperlink or Picture)* A unique URL to the Qualtrics form for faculty to approve or reject the announcement.
  - **ApprovedBy**: *(Person or Group)* The name of the faculty member who approved the announcement.
  - **ApprovedDate**: *(Date and Time)* The date and time when the announcement was approved.
  - **RejectionReason**: *(Multiple lines of text)* If the announcement is rejected, this field captures the reason provided by the faculty member.

- **Setup**:
  - The list is configured to automatically generate `AnnouncementID` using SharePoint's built-in auto-numbering feature.
  - Fields like `Status` are set up as Choice fields to restrict values to options like "Pending Approval," "Approved," and "Rejected."
  - Fields like `GeneratedDate` and `ApprovedDate` automatically capture the current date and time when the respective events occur.
  - `FacultyApprovalURL` is a hyperlink field where Power Automate inserts the unique URL to the Qualtrics approval form for each announcement.

### 2. Approval Log List

This list logs the responses from faculty members regarding the announcements generated by AITA. Each entry corresponds to a faculty member's decision to either approve or reject an announcement.

- **Fields**:
  - **LogID**: *(Number)* A unique identifier for each log entry. This is auto-generated.
  - **AnnouncementID**: *(Number)* A reference to the `AnnouncementID` from the Announcement List.
  - **CourseName**: *(Single line of text)* The name of the course for which the announcement was generated.
  - **FacultyName**: *(Person or Group)* The name of the faculty member who reviewed the announcement.
  - **Decision**: *(Choice)* The faculty member's decision: "Approved" or "Rejected."
  - **DecisionDate**: *(Date and Time)* The date and time when the faculty member made the decision.
  - **RejectionReason**: *(Multiple lines of text)* If the announcement was rejected, this field captures the reason for rejection.
  - **Comments**: *(Multiple lines of text)* Any additional comments or feedback provided by the faculty member.

- **Setup**:
  - The `LogID` is auto-generated using SharePoint's auto-numbering feature.
  - The `AnnouncementID` field establishes a relationship with the `Announcement List` to maintain referential integrity.
  - The `Decision` field is a Choice field limited to "Approved" or "Rejected" to standardize responses.
  - `DecisionDate` automatically captures the date and time of the faculty member's response.

## Workflow Integration with SharePoint Lists

- **Announcement Creation**: When AITA generates an announcement, Power Automate adds a new entry to the Announcement List, including course information, HTML content, and the status set to "Pending Approval."
- **Approval Process**: The `FacultyApprovalURL` directs faculty to a Qualtrics form where they can review the announcement and either approve or reject it. Power Automate logs the decision to the Approval Log List.
- **Logging Decisions**: Upon faculty decision, the status in the Announcement List is updated, and a new entry is created in the Approval Log List with details such as faculty name, decision, and any rejection reasons or comments.

## Setting Up the Lists

### 1. Create the Announcement List
1. Navigate to your SharePoint site.
2. Create a new list and name it (e.g., "AITA Announcements").
3. Add the fields as described above with the appropriate field types (e.g., "Single line of text," "Choice," "Date and Time").
4. Set up any Choice fields (like `Status`) with predefined options.
5. Configure default values and settings as needed (e.g., default `Status` to "Pending Approval").

### 2. Create the Approval Log List
1. Create another list (e.g., "AITA Approval Logs").
2. Add fields to this list as described, ensuring relationships are established where needed (e.g., `AnnouncementID` to reference the Announcement List).
3. Set up the necessary fields, such as `Decision` as a Choice field and `DecisionDate` to capture date and time automatically.

### 3. Configure Permissions
- Ensure that appropriate permissions are set for each list to control who can view and modify the entries. Restrict access to authorized faculty and administrative staff.

This setup allows for effective data management and tracking throughout the AITA process, ensuring that all generated announcements and faculty responses are logged and accessible for review and analysis.
